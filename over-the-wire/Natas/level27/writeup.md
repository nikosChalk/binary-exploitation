# Write up

To login in the domain `http://natas27.natas.labs.overthewire.org` use credentials:

Username: `natas27`<br/>
Password: `55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ`

## This level includes

* PHP SQLi mitigation [`mysql_real_escape_string()`](https://www.php.net/manual/en/function.mysql-real-escape-string.php)
  * Prepends a backslash to the following characters: `\x00`, `\n`, `\r`, `\`, `'`, `"` and `\x1a`.
* MySQL "properly documented bug" (aka unexpected "feature") - [Trailing white spaces are ignored in where clause](https://bugs.mysql.com/bug.php?id=64772)
  * [StackOverflow - Trailing whitespace in varchar needs to be considered in comparison](https://stackoverflow.com/questions/3668996/trailing-whitespace-in-varchar-needs-to-be-considered-in-comparison/10143881#10143881)

## Idea

The idea here is to insert a duplicate user with username `natas28` and with a known to us password. This user already exists in the first place and is the user for whom we want the password. Once we have done that, we can login with that fake user and retrieve the password of the original `natas28` user.

## Solution

Run `python solution.py` in order to solve the level

So to login in the level28 use the credentials:

Username: `natas28`<br/>
Password: `JWwR438wkgTsNKBbcJoowyysdM82YjeF`
