# Write up

To login in the domain `http://natas26.natas.labs.overthewire.org` use credentials:

Username: `natas26`<br/>
Password: `oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T`

## This level includes

* PHP Object Injection

## Idea

This idea here is the the server uses a serialized PHP object as a cookie value. This is unsafe to do so, and can lead Remote Code Execution (RCE) when magic PHP methods are present. In this case, the class `Logger` has the magic method `__destruct()` which allows us to create arbitrary files with arbitrary content.

In our case, we create a PHP file that when executed prints the contents of the file "/etc/natas_webpass/natas27", i.e. the password for the next level. We need to create the file in a directory where we have permission to write. We tried `/tmp` and `/var/www/natas/natas26/index.php` but we were getting "Permission Denied!". So, we use the directory `/var/www/natas/natas26/img` since there we can upload images, meaning that we have permission to write.

Once our malicious PHP file is successfully uploaded to the server, all we have to do is issue a GET request.

## Solution

1. Run `php payload-generator.php` in order to generate the desirable payload.
2. Copy-paste the base64'd payload to the variable `cookie_payload` in solution<span>.p</span>y.
3. Run `python solution.py` in order to solve the level

So to login in the level27 use the credentials:

Username: `natas27`<br/>
Password: `55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ`
