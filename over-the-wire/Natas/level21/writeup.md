# Write up

To login in the domain `http://natas21.natas.labs.overthewire.org` use credentials:

Username: `natas21`<br/>
Password: `IFekPyrQXftziDEsUr3x21sYuahypdgJ`

When we login in this level we are greeted with the message:<br/>
"Note: this website is colocated with [http://natas21-experimenter.natas.labs.overthewire.org](http://natas21-experimenter.natas.labs.overthewire.org)".

The greeting page does not seem to have any vulnerability or any way to input user-data. In order to get the credentials we need to have `$_SESSION["admin"] == 1`. So what we assume here is that the colocated page has some kind of vulnerability and that the same `PHPSESSID` is used across both pages.

When we examine the code of the colocated page, we observer the following PHP snippet:

```php
if(array_key_exists("submit", $_REQUEST)) {
    foreach($_REQUEST as $key => $val) {
        $_SESSION[$key] = $val;
    }
}
```

This lets us insert arbitrary key-value pairs to the `$_SESSION` array. So, lets insert the `$_SESSION["admin"] == 1` pair! By sending a POST request to the domain [http://natas21-experimenter.natas.labs.overthewire.org](http://natas21-experimenter.natas.labs.overthewire.org) with data `submit=1&admin=1` we effectively set `$_SESSION["admin"] == 1`. So using the same `PHPSESSID` we issue a GET request to the original domain [http://natas21.natas.labs.overthewire.org](http://natas21.natas.labs.overthewire.org). When we do so, we are presented with the credentials of level22, for which the password is `chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ`

So to login in the level22 use the credentials:

Username: `natas22`<br/>
Password: `chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ`
