
<?

/*
CREATE TABLE `users` (
  `username` varchar(64) DEFAULT NULL,
  `password` varchar(64) DEFAULT NULL
);
*/

## Lets try Out of Band SQLi (https://medium.com/bugbountywriteup/out-of-band-oob-sql-injection-87b7c666548b)
## Also check: https://github.com/sqlmapproject/sqlmap/wiki/Usage#out-of-band-stateful-connection-meterpreter--friends

if(array_key_exists("username", $_REQUEST)) {
    $link = mysql_connect('localhost', 'natas15', '<censored>');
    mysql_select_db('natas15', $link);
    
    $query = "SELECT * from users where username=\"".$_REQUEST["username"]."\"";
    if(array_key_exists("debug", $_GET)) {
        echo "Executing query: $query<br>";
    }

    $res = mysql_query($query, $link);
    if($res) {
        if(mysql_num_rows($res) > 0) {
            echo "This user exists.<br>";
        } else {
            echo "This user doesn't exist.<br>";
        }
    } else {
        echo "Error in query.<br>";
    }

    mysql_close($link);
} else {
?>

<form action="index.php" method="POST">
Username: <input name="username"><br>
<input type="submit" value="Check existence" />
</form>
<? } ?>


<?

# Example query to execute:
# SELECT * from users where username="natas16" AND password LIKE "a%"

# Necessery input for "username" field
# natas16" AND password LIKE "a%

?>