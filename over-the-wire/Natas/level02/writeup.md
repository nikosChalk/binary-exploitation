# Write up

To login in the domain `https://natas2.natas.labs.overthewire.org/` use credentials:

Username: `natas2`<br/>
Password: `ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi`

In order to get the password for level03 we will use ZAP.

1. Open a new session in ZAP
2. In the default context, select "Include in Context" and add the regex `http://natas2.natas.labs.overthewire.org.*`
3. In "Authentication" select `HTTP/NTLM Authentication` since the web server uses HTTP Authentication header.
    i. As "Hostname" enter `natas2.natas.labs.overthewire.org`
    ii. As Port enter `80`
    iii. Leave "Realm" field blank as when we manually login no "WWW-Authenticate" header is sent.
4. In Users, add a new user with the credentials for this level
5. In Forced User, select the user that you have just created.
6. In Session Management select `HTTP Authentication Session Management` since in each request the "Authentication" header must be present
7. In the Authorization, select as "HTTP Status Code" the value `401` and "At least one of the conditions above must match" option.
8. Click OK
9. Click the "Forced User Mode Enabled" button in the toolbar

Now if you launch spider in the domain `http://natas2.natas.labs.overthewire.org` you should see a GET request for `http://natas2.natas.labs.overthewire.org/files/users.txt` which contains the credentials for level03. So, the password for level03 is `sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14`

So to login in the level03 use the credentials:

Username: `natas3`<br/>
Password: `sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14`

## Reference for ZAP

1. [HTTP/NTLM Authentication](https://www.zaproxy.org/docs/desktop/start/features/authentication/#httpAuth)
2. [HTTP Authentication Session Management](https://www.zaproxy.org/docs/desktop/start/features/sessionmanagement/#hasm)
3. [How can ZAP automatically authenticate via forms?](https://www.zaproxy.org/faq/how-can-zap-automatically-authenticate-via-forms/)
3. [WWW-Authenticate: &lt;type&gt; realm=&lt;realm&gt;\[, charset="UTF-8"\]](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/WWW-Authenticate)
