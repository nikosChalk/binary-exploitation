

from pwn import *

"""pwnlib.tubes module
This module allows us to talk to the challenge binary in a very simple way, even when the binary is located in a remote server.
It exposes an interface to talk to processes, sockets, serial ports, etc.
"""
# Example of remote connections with pwnlib.tubes.remote
conn = remote("192.168.179.129", 2999) # 
line = conn.recvline().decode('ascii')  # printf("Please send '%d' as a little endian 32bit int\n", wanted);
print(" - Received: " + line)

p = re.compile(r".* '(\d+)' .*")
m = p.match(line)

wanted = int(m.group(1))
print(" - Requested number is: " + hex(wanted))

"""pwnlib.utils.packing
This module allows for packing and unpacking integers
"""
wanted = p32(wanted, sign="unsigned", endianness="little")
print(" - Sending payload (hex): " + wanted.hex())

conn.send(wanted)
response = conn.recvall().decode('ascii')
print(response)
conn.close()
