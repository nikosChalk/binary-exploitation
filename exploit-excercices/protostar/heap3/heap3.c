#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <sys/types.h>
#include <stdio.h>

//Address in section .got.plt for puts: 0x0804b128

//Address: 0x08048864
void winner()
{
  printf("that wasn't too bad now, was it? @ %d\n", time(NULL));
}

int main(int argc, char **argv)
{
  // $esp+0x14 == a
  // $esp+0x18 == b
  // $esp+0x1c == c
  char *a, *b, *c;

  a = malloc(32);   //chunk size == 40, which is 8-byte aligned
  b = malloc(32);
  c = malloc(32);

  strcpy(a, argv[1]);
  strcpy(b, argv[2]);
  strcpy(c, argv[3]);

  free(c);
  free(b);
  free(a);

  printf("dynamite failed?\n"); //puts is called in the binary instead of printf
}
