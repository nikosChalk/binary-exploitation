# Use-after-free (UAF)

In this level (heap2) we demonstrate how use after free works. This is displayed in solution1.

<i>Use-after-free</i> vulnerabilities occur when the following pattern is present in the program:

```C
auto x = malloc();
//...
use(x);
free(x);
//...
use(x);
```

In other words, the programmer uses a heap variable, frees it, and then accidentally re-uses it. This can also be seen in this level with the `auth` variable. The following program input triggers a use-after-free:

```C
> auth AAAA
> reset
> login
```

Usually the attacker tries to control the heap layout after the free has occurred and before the bad use.
