# [ropper](https://github.com/sashs/Ropper) python tool

> You can use [ropper](https://github.com/sashs/Ropper) to display information about binary files in different file formats and you can search for gadgets to build rop chains for different architectures.

<b><u>This is the suggested tool for finding rop gadgets in binaries.</b></u>

Examples:

* `ropper --file a.out --search "% ?di"` - Searches for gadgets that use the `edi` or `rdi` registers.
* `ropper --file a.out --search "pop ?di"` - Searches for gadgets that contain a `pop edi` or `pop rdi` instruction.

See also [Basic ROP techniques and tricks](https://trustfoundry.net/basic-rop-techniques-and-tricks/).



# msfelfscan metasploit tool

The metasploit `msfelfscan` tool can be used to find ROP gadgets that control various registers (through `pop <reg>` instructions), perform jumps using values from registers (e.g. `call eax`), and find gadgets like `pop eax; pop ebp; ret`.

For example, `msfelfscan -p stack7` will give us the following result
```assembly
[stack7]
0x08048492 pop ebx; pop ebp; ret
0x080485c7 pop edi; pop ebp; ret
0x080485f7 pop ebx; pop ebp; ret
```

# msfrop metasploit tool

In a similar way, the `msfrop` tool can be used to find various gadgets. This tool is able to find more gadgets than `msfelfscan`. <br/>
For example, when we run `msfrop stack7 -v` some of the output that we get is
```assembly
Collecting gadgets from stack7
Found 14 gadgets

stack7 gadget: 0x0804835d
0x0804835d:	add [eax], al
0x0804835f:	add [ebx-7fh], bl
0x08048362:	ret

stack7 gadget: 0x0804837e
0x0804837e:	add [eax], al
0x08048380:	pop eax
0x08048381:	pop ebx
0x08048382:	leave
0x08048383:	ret

stack7 gadget: 0x0804848f
0x0804848f:	add esp, 4
0x08048492:	pop ebx
0x08048493:	pop ebp
0x08048494:	ret

...
Found 14 gadgets total
```



