# Just copy-paste this script in the (gdb) prompt

shell clear
set confirm off
set disassembly-flavor intel
set follow-fork-mode child
set pagination off
del breakpoints


#get_requests: int i = 0
b *get_requests+155
command $bpnum
echo Breakpoint in, get_requests: int i = 0\n
end

#free
b free
command $bpnum
echo Breakpoint in, free()\n
end

#memmove
b memmove
command $bpnum
echo Breakpoint in, memmove\n
end


# ---------------------------------------------------------------- #
# ---------------------------------------------------------------- #
# ---------------------------------------------------------------- #

define hook-stop

echo \n
p $eip
info symbol $eip
x/10i $eip
echo \n

echo \n
echo ------------------------------ chunk 0 -----------------------------------\n
x/22wx 0x804e000
echo ------------------------------ chunk 1 -----------------------------------\n
x/22wx 0x804e088
echo ------------------------------ chunk 2 -----------------------------------\n
x/22wx 0x804e110
echo ------------------------------ chunk 3 ----------------------------------\n
x/22wx 0x804e198
echo ------------------------------ ----- - -----------------------------------\n

end

# ---------------------------------------------------------------- #
# ---------------------------------------------------------------- #
# ---------------------------------------------------------------- #

set confirm on
shell clear

# attach 1685
