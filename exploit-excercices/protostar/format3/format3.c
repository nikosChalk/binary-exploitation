#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

int target; //Address: 0x080496f4

void printbuffer(char *string)
{
  printf(string);
}

void vuln()
{
  char buffer[512];

  fgets(buffer, sizeof(buffer), stdin);

  printbuffer(buffer);
  
  //Hex    : 0x01025544 == 
  //Decimal: 16930116   ==
  //Binary : 00000001 00000010 01010101 01000100
  //Order of write operations matters because values are written as "int"
  //         [  1   ] [   2  ] [  85  ] [  68  ] Well. Writing to an address with only 1 or 2 characters available is impossible
  //         [      258      ] [  85  ] [  68  ] This seems more doable!
  //         [  1   ] [      597      ] [  68  ]

  //Hex    : 0x01025544 == 
  //Decimal: 16930116   ==
  //Binary : 00000001 00000010 01010101 01000100
  //Memory layout in little endian: 
  //    01000100 01010101 00000010 00000001
  //    [  68  ] [  85  ] [   2  ] [   1  ]
  //    [  68  ] [  85  ] [     513       ]



  //Order of write operations matters because values are written as "int"
  //         [  1   ] [   2  ] [  85  ] [  68  ] Well. Writing to an address with only 1 or 2 characters available is impossible
  //         [      258      ] [  85  ] [  68  ] This seems more doable!
  //         [  1   ] [      597      ] [  68  ]

  if(target == 0x01025544) {
      printf("you have modified the target :)\n");
  } else {
      printf("target is %08x :(\n", target);
  }
}

int main(int argc, char **argv)
{
  vuln();
}