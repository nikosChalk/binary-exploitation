

from pwn import *
import sys

conn = remote("192.168.179.129", 2997)

result = 0
for i in range(0, 4):
    q = conn.recv(4)
    q = int.from_bytes(q, byteorder='little', signed=False)
    result = result + q
print(" - Addtition result: " + str(result))

# Handle integer overflow
result_bits = fiddling.bits(result, endian=sys.byteorder) # convert result to a list of bits
if len(result_bits) > 32:
    print(" - [Warning] Overflow detected. Truncating result in 32 bits")
    result_bits = result_bits[0:32] # truncate result in 32 bits
    result = fiddling.unbits(result_bits, endian=sys.byteorder) # convert the list of bits to bytes object
    result = int.from_bytes(result, byteorder=sys.byteorder, signed=False) # convert the bytes object to an actual int

print(" - Wanted: " + str(result))

payload = p32(result, endian="little", sign=False)
conn.send(payload)

response = conn.recvall().decode('ascii')
print(response)

conn.close()
